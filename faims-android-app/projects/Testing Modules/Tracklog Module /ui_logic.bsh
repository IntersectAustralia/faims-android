// USER
User user; // dont touch
String userid;

populateListForUsers() {
    fetchAll("select userid, fname ||' ' || lname from user", new FetchCallback() {
        onFetch(result) {
            populateList("user/tab1/users", result);
        }
    });
    return users;
}
populateListForUsers();

login(){
    fetchOne("select userid,fname,lname,email from user where userid='" + getListItemValue() + "';", new FetchCallback() {
        onFetch(userResult) {
            user = new User(userResult.get(0),userResult.get(1),userResult.get(2),userResult.get(3));
            setUser(user);
            showTabGroup("menu");
        }
    });
}

onEvent("user/tab1/users", "click", "login()");

// CONTROLS


createOption(name, value) {
	ArrayList option = new ArrayList();
	option.add(name);
	option.add(value);
	return option;
}

options = new ArrayList();
options.add(createOption("trackLog", "Track Log"));

loadOptions() {
	populateList("menu/tab1/options", options);
}

onEvent("menu", "load", "loadOptions()");

onClickOption() {
	String value = getListItemValue();
	if ("trackLog".equals(value)) {
		showTabGroup("tabgroup1");
	} 
}

onEvent("menu/tab1/options", "click", "onClickOption()");




//Test for Tracklog work with pause

setGPSUpdateInterval(4);
onEvent("tabgroup1/tab1/startInternalGPS", "click", "startInternalGPS()");
onEvent("tabgroup1/tab1/startExternalGPS", "click", "startExternalGPS()");
onEvent("tabgroup1/tab1/startTimeLog", "click", "startTrackAlert()");
onEvent("tabgroup1/tab1/stopTrackLog", "click", "stopTrackingGPS()");

startTrackAlert(){
	
	startTrackingGPS("time", 10, "saveTimeGPSTrack()");

}
saveTimeGPSTrack() {
    showToast("still tracking");
    position = getGPSPosition();
    if (position == null) {
        showToast("not gps signal found");
    } else {
        showToast("Longitude:"+position.getLongitude());
    }
}



